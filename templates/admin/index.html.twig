{% extends 'base.html.twig' %}

{% block title %}Admin — Tableau de bord{% endblock %}

{% block stylesheets %}
    <style>
        body { margin: 0; font-family: "Helvetica Neue", Arial, sans-serif; background: #f8f9fb; color: #0f172a; }
        .wrapper { max-width: 1100px; margin: 0 auto; padding: 28px 16px 64px; }
        header { display:flex; justify-content: space-between; align-items: center; margin-bottom: 24px; flex-wrap:wrap; gap:12px; }
        h1 { margin: 0; font-size: 26px; }
        a { color: inherit; text-decoration: none; }
        .pill { display:inline-flex; align-items:center; gap:8px; padding:8px 12px; border-radius: 999px; background:#0f172a; color:#fff; font-weight:700; }
        .panel { background: #fff; border: 1px solid rgba(0,0,0,0.05); border-radius: 12px; padding: 16px; }
        .grid { display:grid; gap:16px; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); }
        .muted { color:#6b7280; margin:0; }
        .stats { display:grid; gap:12px; grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); margin: 0 0 16px 0; }
        .stat-title { margin:0; color:#6b7280; font-size:13px; }
        .stat-value { margin:4px 0 0 0; font-size:24px; font-weight:800; }
        .bar-wrapper { display:flex; gap:6px; align-items:flex-end; margin-top:10px; }
        .bar { width:16px; background:#0f172a; border-radius:6px 6px 0 0; }
        @media (max-width: 720px) {
            .wrapper { padding: 20px 14px 80px; }
            h1 { font-size:22px; }
            .stats { grid-template-columns: 1fr; }
            .grid { grid-template-columns: 1fr; }
            .panel { padding:14px; }
        }
    </style>
{% endblock %}

{% block body %}
    {% set userLabel = stats.connectedEmail ?? (app.user ? (app.user.userIdentifier ?? app.user.email ?? app.user.username ?? 'Admin') : 'Admin') %}
    <div class="wrapper">
        <header>
            <h1>Tableau de bord admin</h1>
            <div style="display:flex; gap:8px; flex-wrap:wrap;">
                <span class="pill" style="background:#e5e7eb; color:#0f172a;">{{ userLabel }}</span>
                <a class="pill" href="{{ path('logout') }}" style="background:#111827; color:#fff;">Déconnexion</a>
                <a class="pill" href="{{ path('shop_home') }}" style="background:#0f172a; color:#fff;">← Retour boutique</a>
            </div>
        </header>

        <div class="stats">
            <div class="panel">
                <p class="stat-title">Colis à préparer</p>
                <p class="stat-value">{{ stats.pendingShipments }}</p>
            </div>
            <div class="panel">
                <p class="stat-title">Nouveaux utilisateurs (semaine)</p>
                <p class="stat-value">{{ stats.newUsers }}</p>
            </div>
            <div class="panel">
                <p class="stat-title">Flux d’expéditions (7j)</p>
                <div class="bar-wrapper">
                    {% for val in stats.weekShipments %}
                        <div class="bar" style="height: {{ 6 + val*4 }}px;"></div>
                    {% endfor %}
                </div>
            </div>
        </div>

        <div class="grid">
            <a class="panel" href="{{ path('admin_product_index') }}" style="text-decoration:none; color:inherit;">
                <h3 style="margin:0 0 6px 0;">Produits</h3>
                <p class="muted">Ajoute et organise tes fiches produits.</p>
            </a>
            <div class="panel">
                <h3 style="margin:0 0 6px 0;">Commandes</h3>
                <p class="muted">Suivi des paiements et expéditions.</p>
            </div>
            <div class="panel">
                <h3 style="margin:0 0 6px 0;">Contenu</h3>
                <p class="muted">Bannières, collections et pages éditoriales.</p>
            </div>
            <a class="panel" href="{{ path('admin_users') }}" style="text-decoration:none; color:inherit;">
                <h3 style="margin:0 0 6px 0;">Clients</h3>
                <p class="muted">Segments, relances et support.</p>
            </a>
        </div>
        <div style="height:40px;"></div>
        <h2>À venir bientôt…</h2>
        <div class="grid">
            <div class="panel">
                <h3 style="margin:0 0 6px 0;">Codes promo</h3>
                <p class="muted">Crée des réductions pour tes clients.</p>
            </div>
            <div class="panel">
                <h3 style="margin:0 0 6px 0;">Statistiques</h3>
                <p class="muted">Analyse les performances de ta boutique.</p>
            </div>
    </div>
{% endblock %}
